cloning section

------------------------------------------
*This project has been created as part of the 42 curriculum by ychattou.*

---

# Inception

## Description

Inception is a system administration project from the 42 curriculum. The goal is to set up a small infrastructure composed of different services running inside Docker containers, orchestrated with Docker Compose, all inside a virtual machine.

The stack consists of three services:

- **NGINX** — acts as the sole entry point, serving HTTPS traffic on port 443 with TLS v1.2/v1.3. All HTTP traffic on port 80 is blocked.
- **WordPress** — runs the WordPress application using PHP-FPM. It is not directly exposed to the outside world.
- **MariaDB** — stores all WordPress data (posts, users, settings). It is only reachable from within the internal Docker network.

All containers communicate over a custom Docker bridge network called `inception`. Data is persisted using Docker volumes backed by bind mounts on the host machine.

### Sources Included

```
srcs/
├── docker-compose.yml
├── .env
└── requirements/
    ├── nginx/        — Custom NGINX image with SSL/TLS config
    ├── wordpress/    — Custom WordPress image with PHP-FPM and WP-CLI
    └── mariadb/      — Custom MariaDB image with init script
```

Each service is built from a custom `Dockerfile` based on `debian:bullseye`. No pre-built application images (such as the official `wordpress` or `nginx` Docker Hub images) are used.

---

### Design Choices

#### Virtual Machines vs Docker

Virtual machines emulate an entire operating system, including a full kernel, on top of a hypervisor. This makes them heavy, slow to start, and resource-intensive. Docker containers, by contrast, share the host kernel and only package the application and its dependencies. This makes them lightweight, fast to start, and much more efficient for running isolated services. In this project, Docker is used to isolate each service (NGINX, WordPress, MariaDB) in its own container while keeping them able to communicate over a shared network.

That said, the project itself runs inside a VM (VirtualBox) as required, which adds an extra layer of isolation between the host machine and the Docker environment.

#### Secrets vs Environment Variables

Environment variables (used here via the `.env` file) are a simple and practical way to pass configuration to containers at runtime. They are easy to use with Docker Compose and sufficient for a development or school context. However, they have a security limitation: they can be exposed through `docker inspect`, process listings, or accidental commits to version control.

Docker Secrets, by contrast, are designed for production environments. They store sensitive data (passwords, tokens) encrypted at rest and only mount them into containers that explicitly need them, reducing exposure. In this project, environment variables are used for simplicity, but in a real production setup, secrets would be the recommended approach for credentials such as database passwords.

#### Docker Network vs Host Network

With **host networking**, a container shares the host machine's network stack directly. This offers maximum performance but eliminates isolation — a container can reach any port on the host and vice versa, which is a security risk.

With a **Docker bridge network** (used here as `inception`), containers get their own isolated network namespace. They can communicate with each other by container name (e.g. `wordpress` can reach `mariadb` simply by using `mariadb` as the hostname), but are isolated from the host and from other networks. Only explicitly published ports (in this case, `443`) are accessible from outside. This is the correct approach for a secure, isolated multi-service setup.

#### Docker Volumes vs Bind Mounts

**Docker volumes** are managed entirely by Docker. They are stored in Docker's internal directory (`/var/lib/docker/volumes/`) and are the recommended way to persist data in production. They are portable, easy to back up with Docker commands, and not tied to the host filesystem structure.

**Bind mounts** (used in this project) map a specific directory on the host machine directly into the container. This gives full visibility and control over where the data lives (here at `/home/yourlogin/data/`), which is practical for development and debugging. The trade-off is that they are tightly coupled to the host filesystem layout.

In this project, bind mounts are used so that data location is explicit and verifiable during evaluation.

---

## Instructions

### Prerequisites

- Docker and Docker Compose installed
- `make` installed
- A Linux system or VM (Debian recommended)

### 1. Clone the repository

```bash
git clone https://github.com/yourlogin/inception.git
cd inception
```

### 2. Create the data directories

Replace `yourlogin` with your system username (`whoami`):

```bash
sudo mkdir -p /home/yourlogin/data/mariadb
sudo mkdir -p /home/yourlogin/data/wordpress
```

### 3. Configure environment variables

Create the `.env` file in `srcs/`:

```bash
cp srcs/.env.example srcs/.env
```

Then edit `srcs/.env` and fill in your values:

```env
DOMAIN_NAME=login.42.fr
MYSQL_DB=
MYSQL_USER=
MYSQL_PASSWORD=
MYSQL_ROOT_PASSWORD=
WP_ADMIN_N=
WP_ADMIN_P=
WP_ADMIN_E=
WP_TITLE=
WP_U_NAME=
WP_U_PASS=
WP_U_ROLE=
WP_U_EMAIL=
```

### 4. Build and start the project

```bash
make
```

This will build all Docker images and start the containers in detached mode.

### 5. Access the website

Open your browser:

```
https://login.42.fr
```

> A browser security warning is expected due to the self-signed certificate. Click **Advanced → Proceed**.

### 6. Access the WordPress admin panel

```
https://login.42.fr/wp-admin
```

### Useful Commands

```bash
# Start all containers
make

# Stop all containers
make down

# Full reset (removes containers, volumes, and data)
make fclean

# Rebuild from scratch
make re

# Check container status
docker-compose -f ./srcs/docker-compose.yml ps

# View logs
docker-compose -f ./srcs/docker-compose.yml logs

# Inspect a volume
docker volume inspect mariadb
docker volume inspect wordpress

# Inspect the network
docker network inspect inception
```

### Further Documentation

- [DEV_DOC.md](DEV_DOC.md) 
- [USER_DOC.md](USER_DOC.md) 

---

## Resources

### Docker & Containers
- [Docker official documentation](https://docs.docker.com)
- [Docker Compose reference](https://docs.docker.com/compose/)
- [Dockerfile best practices](https://docs.docker.com/develop/develop-images/dockerfile_best-practices/)
- [Docker networking overview](https://docs.docker.com/network/)
- [Docker volumes documentation](https://docs.docker.com/storage/volumes/)

### NGINX & TLS
- [NGINX official documentation](https://nginx.org/en/docs/)
- [Mozilla SSL Configuration Generator](https://ssl-config.mozilla.org/)
- [TLS 1.2 vs TLS 1.3 — Cloudflare blog](https://www.cloudflare.com/learning/ssl/why-use-tls-1.3/)

### WordPress & PHP-FPM
- [WordPress developer documentation](https://developer.wordpress.org/)
- [WP-CLI official documentation](https://wp-cli.org/)
- [PHP-FPM configuration guide](https://www.php.net/manual/en/install.fpm.configuration.php)

### MariaDB
- [MariaDB official documentation](https://mariadb.com/kb/en/documentation/)

### Other Ressource Used
- https://medium.com/@afatir.ahmedfatir/unveiling-42-the-network-inception-a-dive-into-docker-and-docker-compose-cfda98d9f4ac
- https://github.com/erdelp/inception-tuto

### AI Usage

AI (Claude by Anthropic) was used throughout this project for the following tasks:

- **Debugging** — identifying issues with MariaDB user permissions, WordPress installation failures, and volume mount paths
- **Networking** — troubleshooting VM network adapter configuration (NAT vs Bridged vs Host-only) to allow host-to-VM communication

AI was used as an assistant and debugging partner, not as a code generator for the core project logic.
